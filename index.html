<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Robotics Camp Registration</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .card {
      display: none;
      border: 1px solid #ccc;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 10px;
    }
    .card.active {
      display: block;
    }
    .bubble-button {
      display: inline-block;
      padding: 10px 20px;
      margin: 5px;
      background-color: #eee;
      border-radius: 20px;
      cursor: pointer;
    }
    .bubble-button.selected {
      background-color: #4CAF50;
      color: white;
    }
    button {
      padding: 10px 20px;
      margin-top: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>Robotics Camp Registration</h1>

  <!-- Step 1: Pick a week -->
  <div id="step1" class="card active">
    <h2>Select a Week</h2>
    <div id="weekButtons">
      <div class="bubble-button" data-value="June 10-14">June 10–14</div>
      <div class="bubble-button" data-value="June 17-21">June 17–21</div>
      <div class="bubble-button" data-value="June 24-28">June 24–28</div>
    </div>
    <button id="next1" disabled>Next</button>
  </div>

  <!-- Step 2: Pick a time -->
  <div id="step2" class="card">
    <h2>Select a Time</h2>
    <form id="timeForm">
      <label><input type="radio" name="time" value="Morning"> Morning (8am–12pm)</label><br>
      <label><input type="radio" name="time" value="Afternoon"> Afternoon (1pm–5pm)</label><br><br>
      <button type="submit">Next</button>
      <button type="button">Back</button>
    </form>
  </div>

  <!-- Step 3: Fill out camper info -->
  <div id="step3" class="card">
    <h2>Camper Information</h2>
    <form id="infoForm">
      <input type="text" name="studentName" placeholder="Student Name" required><br><br>
      <input type="text" name="age" placeholder="Age" required><br><br>
      <input type="text" name="parentName" placeholder="Parent Name" required><br><br>
      <input type="text" name="phone" placeholder="Phone Number" required><br><br>
      <input type="email" name="email" placeholder="Parent Email" required><br><br>
      <input type="text" name="address" placeholder="Address" required><br><br>
      <input type="text" name="city" placeholder="City" required><br><br>
      <input type="text" name="state" placeholder="State" required><br><br>
      <input type="text" name="zip" placeholder="Zip Code" required><br><br>
      <textarea name="notes" placeholder="Notes (Optional)"></textarea><br><br>
      <button type="submit">Next</button>
      <button type="button">Back</button>
    </form>
  </div>

  <!-- Step 4: Choose payment -->
  <div id="step4" class="card">
    <h2>Select Payment Method</h2>
    <form id="paymentForm">
      <label><input type="radio" name="payment" value="Cash"> Cash</label><br>
      <label><input type="radio" name="payment" value="Venmo"> Venmo</label><br><br>
      <button type="submit">Submit Registration</button>
      <button type="button">Back</button>
    </form>
  </div>

  <!-- Step 5: Confirmation -->
  <div id="step5" class="card">
    <h2>Registration Complete!</h2>
    <p>Thank you for registering! Please fill out a new form if you want to register another camper.</p>
  </div>

  <script>
    let formData = { week: "" };

    document.querySelectorAll(".bubble-button").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".bubble-button").forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        formData.week = btn.dataset.value;
        document.getElementById("next1").disabled = false;
      });
    });

    document.getElementById("next1").addEventListener("click", () => showStep(1));

    document.getElementById("timeForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const time = document.querySelector('input[name="time"]:checked');
      if (time) {
        formData.time = time.value;
        showStep(2);
      }
    });

    document.getElementById("infoForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const infoForm = document.getElementById("infoForm");
      new FormData(infoForm).forEach((v, k) => formData[k] = v);
      showStep(3);
    });

    document.getElementById("paymentForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const payment = document.querySelector("input[name='payment']:checked")?.value;
      if (!payment) {
        alert("Please select a payment method.");
        return;
      }

      formData.payment = payment;

      const payload = new URLSearchParams(formData);

      fetch("https://script.google.com/macros/s/AKfycbw4G86YsWDyrrPU8J16k6_dIjXJ89hswDWfkolDEQR4OvfbnMAMaETPEEjxT9bPwhI/exec", {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: payload
      })
      .then(response => response.text())
      .then(result => {
        if (result.includes("Success")) {
          formData = { week: "" };
          showStep(4);
        } else {
          console.error("Server error:", result);
          alert("There was an error submitting. Please try again.");
        }
      })
      .catch(error => {
        console.error("Network error:", error);
        alert("There was a network error. Please try again.");
      });
    });

    // Back buttons
    document.querySelector("#step2 button[type='button']").addEventListener("click", () => showStep(0));
    document.querySelector("#step3 button[type='button']").addEventListener("click", () => showStep(1));
    document.querySelector("#step4 button[type='button']").addEventListener("click", () => showStep(2));

    function showStep(index) {
      document.querySelectorAll(".card").forEach((card, i) =>
        card.classList.toggle("active", i === index)
      );
    }
  </script>

</body>
</html>
